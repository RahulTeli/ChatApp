{"ast":null,"code":"import _asyncToGenerator from \"D:/Projects/ChatApplication/FrontEnd/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as signalR from '@microsoft/signalr';\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"ng-angular-popup\";\nexport class ChatService {\n  constructor(toast) {\n    this.toast = toast;\n    this.message$ = new BehaviorSubject([]);\n    this.ConnectedUsers$ = new BehaviorSubject([]); /// BehaviourSubject is used to transfer data to unconnected component\n    this.messages = [];\n    this.users = [];\n    this.connection = new signalR.HubConnectionBuilder().withUrl(\"http://localhost:5000/chat\").configureLogging(signalR.LogLevel.Information).build();\n    this.start();\n    this.connection.on(\"ReceiveMessage\", (user, message, messageTime) => {\n      this.messages = [...this.messages, {\n        user,\n        message,\n        messageTime\n      }];\n      this.message$.next(this.messages);\n      if (message.includes(\"has Left the Group\") || message.includes(\"has Joined the Group\")) {\n        this.showSuccessTopLeft(message);\n      }\n    });\n    this.connection.on(\"ConnectedUser\", users => {\n      this.ConnectedUsers$.next(users);\n    });\n  }\n  //start connection\n  start() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        yield _this.connection.start();\n        console.warn(\"Connection Established\");\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }\n  //join room\n  joinRoom(user, room) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      return _this2.connection.invoke(\"JoinRoom\", {\n        user,\n        room\n      }); // calling JoinRoom method of backend by providing values as argument\n    })();\n  }\n  // send message\n  sendMessage(message) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      return _this3.connection.invoke(\"SendMessage\", message);\n    })();\n  }\n  //leave chat\n  leaveChat() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      return _this4.connection.stop();\n    })();\n  }\n  showSuccessTopLeft(user) {\n    this.toast.success({\n      detail: \"SUCCESS\",\n      summary: user,\n      duration: 6000,\n      position: \"topRight\"\n    });\n  }\n  static #_ = this.ɵfac = function ChatService_Factory(t) {\n    return new (t || ChatService)(i0.ɵɵinject(i1.NgToastService));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ChatService,\n    factory: ChatService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["signalR","BehaviorSubject","ChatService","constructor","toast","message$","ConnectedUsers$","messages","users","connection","HubConnectionBuilder","withUrl","configureLogging","LogLevel","Information","build","start","on","user","message","messageTime","next","includes","showSuccessTopLeft","_this","_asyncToGenerator","console","warn","error","log","joinRoom","room","_this2","invoke","sendMessage","_this3","leaveChat","_this4","stop","success","detail","summary","duration","position","_","i0","ɵɵinject","i1","NgToastService","_2","factory","ɵfac","providedIn"],"sources":["D:\\Projects\\ChatApplication\\FrontEnd\\ClientApp\\src\\app\\Services\\chat.service.ts"],"sourcesContent":["import { Inject, Injectable } from '@angular/core';\nimport * as signalR from '@microsoft/signalr';\nimport { NgToastService } from 'ng-angular-popup';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChatService {\n\n  \n\n  public message$  = new BehaviorSubject<any>([]);\n  public ConnectedUsers$ = new BehaviorSubject<string[]>([]);   /// BehaviourSubject is used to transfer data to unconnected component\n  public messages :any[] = [];\n  public users:string[] = [];\n\n  constructor(private toast : NgToastService) { \n    this.start();\n    this.connection.on(\"ReceiveMessage\",(user:string,message:string,messageTime:string)=>{\n\n      this.messages = [...this.messages,{user,message,messageTime}];\n\n      this.message$.next(this.messages);\n\n      if(message.includes(\"has Left the Group\") || message.includes(\"has Joined the Group\"))\n      {\n        this.showSuccessTopLeft(message);\n      }\n\n      \n\n    });\n\n    this.connection.on(\"ConnectedUser\",(users:any)=>{\n    this.ConnectedUsers$.next(users);\n    \n    })\n\n  }\n\n  public connection:signalR.HubConnection = new signalR.HubConnectionBuilder().withUrl(\"http://localhost:5000/chat\")\n  .configureLogging(signalR.LogLevel.Information).build();\n\n  //start connection\n  public async start()\n  {\n    try{\n      await this.connection.start();\n      console.warn(\"Connection Established\");\n      \n    }\n    catch(error){\n      console.log(error);\n      \n    }\n  }\n\n  //join room\n  public async joinRoom(user:string,room:string)\n  {\n    return this.connection.invoke(\"JoinRoom\",{user,room});  // calling JoinRoom method of backend by providing values as argument\n  }\n \n\n  // send message\n  public async sendMessage(message:string)\n  {\n    return this.connection.invoke(\"SendMessage\",message);\n  }\n\n\n  //leave chat\n  public async leaveChat()\n  {\n    return this.connection.stop();\n  }\n\n\n  showSuccessTopLeft(user:string) {\n    this.toast.success({detail:\"SUCCESS\",summary:user,duration:6000, position:\"topRight\"});\n  }\n\n\n\n\n\n}\n"],"mappings":";AACA,OAAO,KAAKA,OAAO,MAAM,oBAAoB;AAE7C,SAASC,eAAe,QAAQ,MAAM;;;AAKtC,OAAM,MAAOC,WAAW;EAStBC,YAAoBC,KAAsB;IAAtB,KAAAA,KAAK,GAALA,KAAK;IALlB,KAAAC,QAAQ,GAAI,IAAIJ,eAAe,CAAM,EAAE,CAAC;IACxC,KAAAK,eAAe,GAAG,IAAIL,eAAe,CAAW,EAAE,CAAC,CAAC,CAAG;IACvD,KAAAM,QAAQ,GAAU,EAAE;IACpB,KAAAC,KAAK,GAAY,EAAE;IA0BnB,KAAAC,UAAU,GAAyB,IAAIT,OAAO,CAACU,oBAAoB,EAAE,CAACC,OAAO,CAAC,4BAA4B,CAAC,CACjHC,gBAAgB,CAACZ,OAAO,CAACa,QAAQ,CAACC,WAAW,CAAC,CAACC,KAAK,EAAE;IAxBrD,IAAI,CAACC,KAAK,EAAE;IACZ,IAAI,CAACP,UAAU,CAACQ,EAAE,CAAC,gBAAgB,EAAC,CAACC,IAAW,EAACC,OAAc,EAACC,WAAkB,KAAG;MAEnF,IAAI,CAACb,QAAQ,GAAG,CAAC,GAAG,IAAI,CAACA,QAAQ,EAAC;QAACW,IAAI;QAACC,OAAO;QAACC;MAAW,CAAC,CAAC;MAE7D,IAAI,CAACf,QAAQ,CAACgB,IAAI,CAAC,IAAI,CAACd,QAAQ,CAAC;MAEjC,IAAGY,OAAO,CAACG,QAAQ,CAAC,oBAAoB,CAAC,IAAIH,OAAO,CAACG,QAAQ,CAAC,sBAAsB,CAAC,EACrF;QACE,IAAI,CAACC,kBAAkB,CAACJ,OAAO,CAAC;;IAKpC,CAAC,CAAC;IAEF,IAAI,CAACV,UAAU,CAACQ,EAAE,CAAC,eAAe,EAAET,KAAS,IAAG;MAChD,IAAI,CAACF,eAAe,CAACe,IAAI,CAACb,KAAK,CAAC;IAEhC,CAAC,CAAC;EAEJ;EAKA;EACaQ,KAAKA,CAAA;IAAA,IAAAQ,KAAA;IAAA,OAAAC,iBAAA;MAEhB,IAAG;QACD,MAAMD,KAAI,CAACf,UAAU,CAACO,KAAK,EAAE;QAC7BU,OAAO,CAACC,IAAI,CAAC,wBAAwB,CAAC;OAEvC,CACD,OAAMC,KAAK,EAAC;QACVF,OAAO,CAACG,GAAG,CAACD,KAAK,CAAC;;IAEnB;EACH;EAEA;EACaE,QAAQA,CAACZ,IAAW,EAACa,IAAW;IAAA,IAAAC,MAAA;IAAA,OAAAP,iBAAA;MAE3C,OAAOO,MAAI,CAACvB,UAAU,CAACwB,MAAM,CAAC,UAAU,EAAC;QAACf,IAAI;QAACa;MAAI,CAAC,CAAC,CAAC,CAAE;IAAA;EAC1D;EAGA;EACaG,WAAWA,CAACf,OAAc;IAAA,IAAAgB,MAAA;IAAA,OAAAV,iBAAA;MAErC,OAAOU,MAAI,CAAC1B,UAAU,CAACwB,MAAM,CAAC,aAAa,EAACd,OAAO,CAAC;IAAC;EACvD;EAGA;EACaiB,SAASA,CAAA;IAAA,IAAAC,MAAA;IAAA,OAAAZ,iBAAA;MAEpB,OAAOY,MAAI,CAAC5B,UAAU,CAAC6B,IAAI,EAAE;IAAC;EAChC;EAGAf,kBAAkBA,CAACL,IAAW;IAC5B,IAAI,CAACd,KAAK,CAACmC,OAAO,CAAC;MAACC,MAAM,EAAC,SAAS;MAACC,OAAO,EAACvB,IAAI;MAACwB,QAAQ,EAAC,IAAI;MAAEC,QAAQ,EAAC;IAAU,CAAC,CAAC;EACxF;EAAC,QAAAC,CAAA,G;qBAzEU1C,WAAW,EAAA2C,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,cAAA;EAAA;EAAA,QAAAC,EAAA,G;WAAX/C,WAAW;IAAAgD,OAAA,EAAXhD,WAAW,CAAAiD,IAAA;IAAAC,UAAA,EAFV;EAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}